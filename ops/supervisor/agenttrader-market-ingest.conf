[program:agenttrader-market-ingest]
directory=/opt/agenttrader/agent-trader-v2
user=agenttrader

# Load secrets/config from an env file without printing them.
# - `set -a` exports sourced variables into the process environment
command=/bin/bash -lc 'set -a; . /etc/agenttrader/market-ingest.env; exec /usr/bin/python3 -m backend.ingestion.market_data_ingest'

autostart=true
autorestart=true

# Backoff / storm prevention
startsecs=10
startretries=3

stopsignal=INT
stopwaitsecs=30

# Log rotation (Supervisor-managed)
stdout_logfile=/var/log/agenttrader/market-ingest.stdout.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
stderr_logfile=/var/log/agenttrader/market-ingest.stderr.log
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=10

environment=PYTHONUNBUFFERED="1",PYTHONDONTWRITEBYTECODE="1",PYTHONPATH="/opt/agenttrader/agent-trader-v2"

